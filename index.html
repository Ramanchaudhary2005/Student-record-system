<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Analytics Dashboard</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="app-shell">
  <aside class="sidebar">
    <div class="brand-bar">
      <span class="brand-name">School</span>
      <span class="brand-tag">SMS</span>
    </div>

    <p class="sidebar-section">Dashboard</p>
    <nav class="sidebar-nav">
      <button class="nav-item active" type="button" data-view="profile">Student Profile</button>
      <button class="nav-item" type="button" data-view="results">Results</button>
      <button class="nav-item" type="button" data-view="attendance">Attendance</button>
      <button class="nav-item" type="button" data-view="messages">Messages</button>
      <button class="nav-item" type="button" data-view="account">Account</button>
    </nav>

    <button class="mode-btn" type="button" onclick="toggleMode()">Toggle Theme</button>
  </aside>

  <main class="main-content">
    <header class="topbar">
      <div>
        <p class="crumb">Home / Student Records</p>
        <h1>Welcome To School Management System</h1>
      </div>
      <div class="topbar-right">
        <input id="topSearch" class="top-search" type="text" placeholder="Search by roll, name, or phone..." aria-label="Search">
        <button class="top-refresh" type="button" onclick="displayStudents()">Refresh</button>
      </div>
    </header>

    <section class="view-section" data-view="profile">
      <section class="dashboard-grid">
        <article class="panel form-panel">
          <div class="panel-head">
            <h2>Add Student</h2>
            <p>Create, update, and delete records.</p>
          </div>

          <div class="form-grid">
            <label>Roll
              <input id="roll" placeholder="e.g. 2901">
            </label>
            <label>Name
              <input id="name" placeholder="Student Name">
            </label>
            <label>Phone
              <input id="phone" placeholder="Phone Number">
            </label>
            <label>Address
              <input id="address" placeholder="Address">
            </label>
            <label>Total Fee
              <input id="feeTotal" type="number" min="0" placeholder="e.g. 1500">
            </label>
            <label>Paid Fee
              <input id="feePaid" type="number" min="0" placeholder="e.g. 1000">
            </label>
            <label>Fee Due Date
              <input id="feeDueDate" type="date">
            </label>
            <label class="full-width">Photo
              <input type="file" id="photo" accept="image/*">
            </label>
          </div>

          <h3 class="marks-title">Marks</h3>
          <div class="marks-grid">
            <label>DSA
              <input id="dsa" type="number" min="0" max="100" placeholder="0-100">
            </label>
            <label>OS
              <input id="os" type="number" min="0" max="100" placeholder="0-100">
            </label>
            <label>DBMS
              <input id="dbms" type="number" min="0" max="100" placeholder="0-100">
            </label>
            <label>CN
              <input id="cn" type="number" min="0" max="100" placeholder="0-100">
            </label>
          </div>

          <div class="action-row">
            <button type="button" onclick="addStudent()">Add Student</button>
            <button type="button" onclick="updateStudent()">Update</button>
            <button type="button" onclick="deleteStudent()">Delete</button>
          </div>
        </article>

        <article class="panel right-panel">
          <div class="metrics-grid">
            <article class="metric-card metric-red">
              <p class="metric-value" id="statFees">0</p>
              <p class="metric-label">Due Fees</p>
            </article>
            <article class="metric-card metric-green">
              <p class="metric-value" id="statStudents">0</p>
              <p class="metric-label">Active Records</p>
            </article>
            <article class="metric-card metric-blue">
              <p class="metric-value" id="statTopper">0</p>
              <p class="metric-label">Top Score</p>
            </article>
            <article class="metric-card metric-teal">
              <p class="metric-value" id="statAverage">0.00%</p>
              <p class="metric-label">Class Average</p>
            </article>
          </div>

          <div class="search-card">
            <h2>Search Student</h2>
            <p>Find and sort records quickly.</p>
            <div class="search-row">
              <input id="searchRoll" placeholder="Enter Roll / Name / Phone">
              <button type="button" onclick="searchStudent()">Search</button>
            </div>
            <div class="secondary-actions">
              <button type="button" onclick="sortTopper()">Topper Sort</button>
              <button type="button" onclick="displayStudents()">Show All</button>
            </div>
            <div class="filter-row">
              <select id="filterFeeStatus" aria-label="Filter by fee status">
                <option value="all">All Fee Status</option>
                <option value="due">Fee Due Only</option>
                <option value="paid">Fully Paid</option>
              </select>
              <select id="filterTopperStatus" aria-label="Filter by topper status">
                <option value="all">All Students</option>
                <option value="topper">Topper Only</option>
              </select>
            </div>
            <div class="subject-sort-row">
              <select id="subjectSort" aria-label="Select subject for topper sort">
                <option value="dsa">DSA Topper</option>
                <option value="os">OS Topper</option>
                <option value="dbms">DBMS Topper</option>
                <option value="cn">CN Topper</option>
              </select>
              <button type="button" class="subject-sort-btn" onclick="sortSubjectTopper()">Subject Topper Sort</button>
            </div>

            <div class="import-box">
              <h3>Import From Excel</h3>
              <p>Accepted: .xlsx, .xls, .csv</p>
              <div class="import-row">
                <input id="excelFile" type="file" accept=".xlsx,.xls,.csv">
                <button class="import-btn" type="button" onclick="importStudentsFromExcel()">Import</button>
              </div>
              <p class="import-hint">Columns: Roll, Name, Phone, Address, DSA, OS, DBMS, CN, FeeTotal, FeePaid, FeeDueDate (optional).</p>
            </div>

            <div class="export-row">
              <button type="button" class="export-btn csv-btn" onclick="exportStudentsCSV()">Export CSV</button>
              <button type="button" class="export-btn xlsx-btn" onclick="exportStudentsExcel()">Export Excel</button>
              <button type="button" class="export-btn print-btn" onclick="printReportCard()">Print Report Card</button>
            </div>

            <div class="fee-box">
              <h3>Fee Payments</h3>
              <p>Installment history, due date tracking, late fee, and receipts.</p>
              <div class="fee-payment-grid">
                <input id="paymentRoll" placeholder="Roll Number">
                <input id="paymentAmount" type="number" min="0" placeholder="Installment Amount">
                <input id="paymentDate" type="date">
                <select id="paymentMethod" aria-label="Payment method">
                  <option value="Cash">Cash</option>
                  <option value="UPI">UPI</option>
                  <option value="Card">Card</option>
                  <option value="Bank Transfer">Bank Transfer</option>
                </select>
              </div>
              <input id="paymentNote" class="payment-note" placeholder="Optional note">
              <div class="fee-actions">
                <button type="button" class="receipt-btn" onclick="recordPayment()">Add Installment</button>
                <button type="button" class="receipt-btn secondary" onclick="generateFeeReceipt()">Generate Receipt</button>
              </div>
            </div>
          </div>
        </article>
      </section>

      <section id="result" class="panel result-panel">
        <div class="result-empty">Search a roll number to view student details.</div>
      </section>

      <section class="panel table-panel">
        <div class="panel-head table-head">
          <h2>Student Table</h2>
          <p>Live overview of all records.</p>
        </div>
        <div class="table-wrap">
          <table id="table">
            <tr>
              <th>Photo</th>
              <th>Name</th>
              <th>Roll</th>
              <th>Total</th>
              <th>%</th>
              <th>Paid</th>
              <th>Left</th>
              <th>Late Fee</th>
            </tr>
          </table>
        </div>
      </section>
    </section>

    <section class="view-section is-hidden" data-view="results">
      <article class="panel">
        <div class="panel-head">
          <h2>Results Board</h2>
          <p>Students ranked by total score.</p>
        </div>
        <div id="resultsBoard" class="status-board"></div>

        <div class="charts-grid">
          <article class="chart-card">
            <h3>Class Average Trend</h3>
            <canvas id="chartAvgTrend"></canvas>
          </article>
          <article class="chart-card">
            <h3>Subject-wise Performance</h3>
            <canvas id="chartSubjectWise"></canvas>
          </article>
          <article class="chart-card">
            <h3>Fee Collection vs Pending</h3>
            <canvas id="chartFeeSplit"></canvas>
          </article>
        </div>
      </article>
    </section>

    <section class="view-section is-hidden" data-view="attendance">
      <article class="panel">
        <div class="panel-head">
          <h2>Attendance Board</h2>
          <p>Mark each student as Present or Absent.</p>
        </div>
        <div id="attendanceBoard" class="status-board attendance-board"></div>
      </article>
    </section>

    <section class="view-section is-hidden" data-view="messages">
      <article class="panel">
        <div class="panel-head">
          <h2>Messages</h2>
          <p>Class updates based on current records.</p>
        </div>
        <div id="messagesBoard" class="status-board"></div>
      </article>
    </section>

    <section class="view-section is-hidden" data-view="account">
      <article class="panel">
        <div class="panel-head">
          <h2>Account</h2>
          <p>Quick admin summary.</p>
        </div>
        <div id="accountBoard" class="status-board"></div>
      </article>
    </section>
  </main>
</div>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="script.js"></script>
</body>
</html>
